<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>「Kaggle API」を Python で実行してみた - Doarakko WorkSpace</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u300cKaggle API\u300d\u3092 Python \u3067\u5b9f\u884c\u3057\u3066\u307f\u305f";
    var mkdocs_page_input_path = "article/kaggle/kaggle-api-in-python.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Doarakko WorkSpace</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../..">Doarakko WorkSpace</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Article</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../">Article</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Challenge</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../challenge/sphinx/">ドキュメント作成によく使われているカッコいいテーマを使って Github Pages を作ってみた</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../challenge/xonsh/">話題沸騰中の「Xonsh」というものを触ってみました</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Coursera</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../coursera/coursera-kaggle-1/">仕事をしながら Coursera の Kaggle コースを受けてみる ①</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../coursera/coursera-kaggle-2/">仕事をしながら Coursera の Kaggle コースを受けてみる ②</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Etc</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../etc/attention-github-pages-branch-name/">【GitHub Pages】Web ページを公開する際のブランチ名</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../etc/chatwork-post-image/">ChatWork に画像をアップロード in Python</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Face recognition</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../face-recognition/facepp-clip-face/">「Face++ Detect API」でローカル画像から一定条件を満たす顔を切り取る in Python</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Heroku</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../heroku/attention-google-api-python-client-in-heroku/">【Heroku】google-api-python-client を使用する際の注意点</a>
                </li>
    </ul>
                </li>
                <li class=" current">
                    
    <span class="caption-text">Kaggle</span>
    <ul class="subnav">
                <li class="toctree-l3 current">
                    
    <a class="current" href="./">「Kaggle API」を Python で実行してみた</a>
    <ul class="subnav">
            
    <li class="toctree-l4"><a href="#kaggle-api-python">「Kaggle API」を Python で実行してみた</a></li>
    
        <ul>
        
            <li><a class="toctree-l5" href="#_1">はじめに</a></li>
        
            <li><a class="toctree-l5" href="#_2">概要</a></li>
        
            <li><a class="toctree-l5" href="#_3">実行環境</a></li>
        
            <li><a class="toctree-l5" href="#_4">準備</a></li>
        
            <li><a class="toctree-l5" href="#_5">試してみる</a></li>
        
            <li><a class="toctree-l5" href="#_7">メリット</a></li>
        
            <li><a class="toctree-l5" href="#_8">注意点</a></li>
        
            <li><a class="toctree-l5" href="#_9">おわりに</a></li>
        
            <li><a class="toctree-l5" href="#_10">参考資料</a></li>
        
            <li><a class="toctree-l5" href="#hints">Hints</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../kaggle-competitions-calendar/">Kaggle の Google Calendar を作りました</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../kaggle-kernel-notification/">【Kaggle】Python + Heroku で新規投稿された Kernel を Slack に通知</a>
                </li>
    </ul>
                </li>
                <li class="">
                    
    <span class="caption-text">Scraping</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../scraping/excite-image-scraping/">Excite image scraping</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../scraping/get-connpass-event-info/">Connpass のイベント情報を取得する in Python</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../scraping/get-youtube-comment/">Youtube のコメントを取得する in Python</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Event</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../event/">Event</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../event/apache-arrow-tokyo-meetup-2018/">Apache Arrow東京ミートアップ2018</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../event/julia-tokyo-8/">JuliaTokyo #8</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../event/pre-event-baseball-data-hackathon/">[【プレイベント】パ・リーグ×パーソル　ベースボールデータハッカソン](https://techplay.jp/event/688365)</a>
                </li>
                <li class="">
                    
    <span class="caption-text">Dena techcon 2019</span>
    <ul class="subnav">
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/">[DeNA TechCon 2019](https://techcon.dena.com/2019/)</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/dena-and-aws/">【対談：DeNA x AWS】クラウドジャーニーのこれまでとこれから</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/dena-and-gcp/">DeNA と Google Cloud Platform</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/game-cheat-step/">スマホゲームのチート手法とその対策</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/qa-test/">DeNAの品質を支えるQAの取り組み 〜標準化から実践まで〜</a>
                </li>
                <li class="toctree-l3">
                    
    <a class="" href="../../../event/dena-techcon-2019/work-and-kaggle/">パネルディスカッション：データサイエンスの競技者、Kagglerたちが活躍する職場とは</a>
                </li>
    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Note</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../../note/">Note</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/command/">Command</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/git/">Git</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/github/">GitHub</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/heroku/">Heroku</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/mkdocs/">MkDocs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../../note/sphinx/">Sphinx</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Doarakko WorkSpace</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Kaggle &raquo;</li>
        
      
        
          <li>Article &raquo;</li>
        
      
    
    <li>「Kaggle API」を Python で実行してみた</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="kaggle-api-python">「Kaggle API」を Python で実行してみた</h1>
<h2 id="_1">はじめに</h2>
<p>「<a href="https://qiita.com/advent-calendar/2018/kaggle-part2">kaggle その2 Advent Calendar 2018</a>」2 日目の記事です。</p>
<h2 id="_2">概要</h2>
<p>Kaggle API を Python 上で実行します（<u><b><code>kaggle</code> コマンドを実行するわけではありません</b></u>）。</p>
<h2 id="_3">実行環境</h2>
<ul>
<li>
<p>anaconda3-5.2.0</p>
<ul>
<li>Python 3.6.5<ul>
<li>kaggle 1.5.0</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Kaggle API Key</p>
<ul>
<li>説明は省きます</li>
<li><code>kaggle</code> コマンドが実行できるような状態にしておいてください</li>
</ul>
</li>
</ul>
<h2 id="_4">準備</h2>
<h3 id="1-kaggle">1. kaggle ライブラリをインポート</h3>
<p><code>kaggle</code>コマンドは Python で作られているので、Github を見ながらうまいことインポートします。</p>
<pre><code class="python">from kaggle.api.kaggle_api_extended import KaggleApi
</code></pre>

<h3 id="2-kaggleapi">2. KaggleApi クラスのインスタンスを準備</h3>
<p><code>KaggleApi</code> クラスにいろいろな処理が書かれているので、こちらのインスタンスを準備して、<code>api</code>経由でいろいろな関数を実行して行きます。</p>
<pre><code class="python"># KaggleApi のインスタンスを用意
api = KaggleApi()
</code></pre>

<h3 id="3">3. 認証を通す</h3>
<p>このままだと認証通っていないので、エラーになります。</p>
<p>そこで<code>api.authenticate()</code>を実行します。<br />
ローカルにある <code>~/.kaggle/kaggle.json</code>を読み込みに行って、なんやかんやしてくれます。</p>
<pre><code class="python"># 認証を通す
api.authenticate()
</code></pre>

<h2 id="_5">試してみる</h2>
<p>コンペのリストを表示させてみます。</p>
<pre><code class="python"># $ kaggle competitions list
api.competitions_list_cli()
</code></pre>

<pre><code>ref                                            deadline             category            reward  teamCount  userHasEntered
---------------------------------------------  -------------------  ---------------  ---------  ---------  --------------
digit-recognizer                               2030-01-01 00:00:00  Getting Started  Knowledge       2724           False
titanic                                        2030-01-01 00:00:00  Getting Started  Knowledge      10359            True
house-prices-advanced-regression-techniques    2030-01-01 00:00:00  Getting Started  Knowledge       4300           False
imagenet-object-localization-challenge         2029-12-31 07:00:00  Research         Knowledge         30           False
competitive-data-science-predict-future-sales  2019-12-31 23:59:00  Playground           Kudos       1823            True
histopathologic-cancer-detection               2019-03-31 23:59:00  Playground       Knowledge         80           False
quora-insincere-questions-classification       2019-02-05 23:59:00  Featured           $25,000       1315            True
pubg-finish-placement-prediction               2019-01-30 23:59:00  Playground            Swag        705           False
human-protein-atlas-image-classification       2019-01-10 23:59:00  Featured           $37,000       1174           False
traveling-santa-2018-prime-paths               2019-01-10 23:59:00  Featured           $25,000        547            True
two-sigma-financial-news                       2019-01-08 23:59:00  Featured          $100,000       1828            True
PLAsTiCC-2018                                  2018-12-17 23:59:00  Featured           $25,000        737            True
quickdraw-doodle-recognition                   2018-12-04 23:59:00  Featured           $25,000       1214           False
ga-customer-revenue-prediction                 2018-11-30 23:59:00  Featured           $45,000        813            True
dont-call-me-turkey                            2018-11-26 23:59:00  Playground            Swag        223           False
airbus-ship-detection                          2018-11-14 23:59:00  Featured           $60,000        884           False
inclusive-images-challenge                     2018-11-12 23:59:00  Research           $25,000        468           False
rsna-pneumonia-detection-challenge             2018-10-31 23:59:00  Featured           $30,000       1499           False
tgs-salt-identification-challenge              2018-10-19 23:59:00  Featured          $100,000       3234           False
new-york-city-taxi-fare-prediction             2018-09-25 23:59:00  Playground       Knowledge       1488           False
</code></pre>

<p>ソースをざっと確認しましたが、<code>kaggle</code>コマンドで実行できる関数は<code>*_cli()</code>という名前になっています。</p>
<p>これを使っても何の意味もないので、<code>kaggle</code>コマンドで直接実行できないものをいくつか使ってみました。</p>
<h3 id="_6">各コンペの情報を取得</h3>
<p><code>competitions_list</code>はコンペの情報を取ってこれます。</p>
<pre><code class="python">competitions_list = api.competitions_list(category='featured')
for competition in competitions_list:
    print(competition)
</code></pre>

<pre><code>vsb-power-line-fault-detection
humpback-whale-identification
elo-merchant-category-recommendation
ga-customer-revenue-prediction
quora-insincere-questions-classification
human-protein-atlas-image-classification
traveling-santa-2018-prime-paths
two-sigma-financial-news
PLAsTiCC-2018
quickdraw-doodle-recognition
airbus-ship-detection
rsna-pneumonia-detection-challenge
tgs-salt-identification-challenge
google-ai-open-images-object-detection-track
google-ai-open-images-visual-relationship-track
home-credit-default-risk
santander-value-prediction-challenge
trackml-particle-identification
youtube8m-2018
avito-demand-prediction
</code></pre>

<p>どんな情報が入っているか見てみます。</p>
<pre><code class="python">for key in dir(competitions_list[0]):
    print('{}: {}'.format(key, getattr(competitions_list[0], key)))
</code></pre>

<pre><code># 一部省略
awardsPoints: True
category: Featured
deadline: 2019-03-21 23:59:00
description: Can you detect faults in above-ground electrical lines?
enabledDate: 2018-12-20 23:08:48
evaluationMetric: Matthews correlation coefficient
id: 10684
isKernelsSubmissionsOnly: False
kernelCount: 0
maxDailySubmissions: 2
maxTeamSize: 8
mergerDeadline: 2019-03-14 23:59:00
newEntrantDeadline: 2019-03-14 23:59:00
organizationName: Enet Centre, VSB - T.U. of Ostrava
organizationRef: Enet-Centre-VSB
ref: vsb-power-line-fault-detection
reward: $25,000
submissionsDisabled: False
tags: [tabular data, signal processing, binary classification]
teamCount: 60
title: VSB Power Line Fault Detection
url: https://www.kaggle.com/c/vsb-power-line-fault-detection
userHasEntered: False
userRank: None
</code></pre>

<p><code>$ kaggle competitions list</code> では取ってこれない情報がけっこうあるのがわかります。</p>
<h3 id="kernel">Kernel の情報を取得</h3>
<pre><code class="python">kernels_list = api.kernels_list(competition='elo-merchant-category-recommendation')
for key in dir(kernels_list[0]):
    print('{}: {}'.format(key, getattr(kernels_list[0], key)))
</code></pre>

<pre><code># 一部省略
author: FabienDaniel
categoryIds: []
competitionDataSources: []
datasetDataSources: []
enableGpu: None
enableInternet: None
id: 0
isPrivate: None
kernelDataSources: []
kernelType: None
language: None
lastRunTime: 2018-12-13 17:08:06
ref: fabiendaniel/elo-world
slug: None
title: Elo world
totalVotes: 261
</code></pre>

<h2 id="_7">メリット</h2>
<h3 id="1-kaggle_1">1. <code>kaggle</code>コマンドでは見れない情報を取得できる</h3>
<p>上でいくつか試したように、<code>kaggle</code>コマンドでは見れない情報がたくさんあります。</p>
<p>簡単なツールを作りにはちょうどいいです。</p>
<h3 id="2">2. 利用規約に違反しない</h3>
<p>Kaggle は公式がスクレイピングを禁止しています。</p>
<blockquote>
<blockquote>
<p>“Crawls,” “scrapes,” or “spiders” any page, data, or portion of or relating to the Services or Content (through use of manual or automated means);</p>
</blockquote>
<p>A violation of any of the foregoing is grounds for termination of your right to use or access the Services. We reserve the right to remove any Content or User Submissions from the Services at any time, for any reason (including if someone alleges you contributed that Content in violation of these Terms), and without notice.</p>
</blockquote>
<p><a href="https://www.kaggle.com/terms">Terms of Use</a>（2018/11/25）</p>
<p>禁止というよりは「やったらいつでも◯すから、気をつけてね」の方が正しいかもしれません。</p>
<p>スクレイピングで取ってこれる情報量には敵いませんが、ちょっとしたツールを作るにはちょうどいいです。</p>
<h2 id="_8">注意点</h2>
<p>Kaggle API は API Limit が公開されていない上に不安定です。</p>
<p>加えて、Python プログラム上での使用は推奨された使い方ではありません。</p>
<p>使いすぎて垢バンされないように気をつけてください。</p>
<p>以下 GitHub に API Limit 関連の issue が上がっています。
[https://github.com/Kaggle/kaggle-api/issues/132:embed:cite]</p>
<h2 id="_9">おわりに</h2>
<p>だれかが便利なものを作ってくれると期待しています。</p>
<h2 id="_10">参考資料</h2>
<ul>
<li><a href="https://github.com/Kaggle/kaggle-api">Kaggle API</a></li>
<li><a href="https://www.kaggle.com/terms">Kaggle 利用規約</a></li>
</ul>
<h2 id="hints">Hints</h2>
<ul>
<li><a href="https://doarakko.hatenablog.com/entry/kaggle_api_in_python">Hatena Blog</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../kaggle-competitions-calendar/" class="btn btn-neutral float-right" title="Kaggle の Google Calendar を作りました">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../heroku/attention-google-api-python-client-in-heroku/" class="btn btn-neutral" title="【Heroku】google-api-python-client を使用する際の注意点"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../heroku/attention-google-api-python-client-in-heroku/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../kaggle-competitions-calendar/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
